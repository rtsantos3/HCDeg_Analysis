plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(18)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
fam_cols2  <- c("001219","005f73","0a9396","94d2bd","e9d8a6","ee9b00","ca6702","bb3e03","ae2012","9b2226")
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
kegg_strat_relcounts_class <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Class'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-class-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot7 <- ggplot(kegg_strat_relcounts_class, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot7)
dev.off()
plot(plot7)
kegg_strat_relcounts_unfiltered_fam <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Family'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum))  #Summarise based on taxon_rel
pdf(file = "./out/unfiltered-relcounts-KEGG-Family.pdf",
width = 10,
height = 20)
plot8 <- ggplot(kegg_strat_relcounts_unfiltered_fam, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot8)
dev.off()
plot(plot8)
kegg_strat_relcounts_genus <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = ifelse(is.na(taxa_vsearch[taxon,'Genus'])==TRUE,taxa_vsearch[taxon, 'Family'], taxa_vsearch[taxon,'Genus']), taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-GenusFam-relcounts-KEGG.pdf",
width = 10,
height = 9)
plot9 <- ggplot(kegg_strat_relcounts_genus, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot9)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
fam_cols2  <- c("001219","005f73","0a9396","94d2bd","e9d8a6","ee9b00","ca6702","bb3e03","ae2012","9b2226")
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
kegg_strat_relcounts_class <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Class'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-class-relcounts-KEGG.pdf",
width = 10,
height = 7)
plot7 <- ggplot(kegg_strat_relcounts_class, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot7)
dev.off()
plot(plot7)
kegg_strat_relcounts_unfiltered_fam <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Family'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum))  #Summarise based on taxon_rel
pdf(file = "./out/unfiltered-relcounts-KEGG-Family.pdf",
width = 10,
height = 20)
plot8 <- ggplot(kegg_strat_relcounts_unfiltered_fam, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot8)
dev.off()
plot(plot8)
kegg_strat_relcounts_genus <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = ifelse(is.na(taxa_vsearch[taxon,'Genus'])==TRUE,taxa_vsearch[taxon, 'Family'], taxa_vsearch[taxon,'Genus']), taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-GenusFam-relcounts-KEGG.pdf",
width = 10,
height = 9)
plot9 <- ggplot(kegg_strat_relcounts_genus, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot9)
dev.off()
plot(plot9)
pdf(file = "./out/Stacked-GenusFam-relcounts-KEGG.pdf",
width = 20,
height = 10)
ggarrange(plot6, plot9, nrow = 2, align ='v')
library(ggpubr)
pdf(file = "./out/Stacked-GenusFam-relcounts-KEGG.pdf",
width = 20,
height = 10)
ggarrange(plot6, plot9, nrow = 2, align ='v')
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
#This code block is to visualize the generated filtered table above
fam_list <- c(unique(kegg_strat_relcounts$taxon))
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-Family-KEGG-Relcounts.pdf",
width = 12,
height = 5)
#This function plots all the stratified abundances in a single row
plot4<- ggplot(kegg_strat_relcounts, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot4)
dev.off()
plot(plot4)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
fam_cols  <- distinctColorPlette(20)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
kegg_strat_relcounts_order <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Order'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
fam_cols  <- distinctColorPalette(20)
pdf(file = "./out/Per-order-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot5<- ggplot(kegg_strat_relcounts_order, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot5)
dev.off()
plot(plot5)
fam_cols  <- distinctColorPlette(20)
fam_cols  <- distinctColorPalette(20)
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
fam_cols  <- distinctColorPalette(20)
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
fam_cols  <- distinctColorPalette(20)
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
fam_cols  <- distinctColorPalette(20)
kegg_strat_relcounts_phylum <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Phylum'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-phylum-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot6<- ggplot(kegg_strat_relcounts_phylum, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot6)
dev.off()
plot(plot6)
kegg_strat_relcounts_class <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Class'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-class-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot7 <- ggplot(kegg_strat_relcounts_class, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot7)
dev.off()
plot(plot7)
kegg_strat_relcounts_class <- strat_kegg %>% transmute(description = as.factor(description), sample, taxon = taxa_vsearch[taxon, 'Class'], taxon_rel_function_abun) %>% group_by(sample, description,taxon) %>% summarise(across(taxon_rel_function_abun, sum)) %>% filter(description %in% deg_df$pathway_desc) #Summarise based on taxon_rel
pdf(file = "./out/Per-class-relcounts-KEGG.pdf",
width = 14,
height = 7)
plot7 <- ggplot(kegg_strat_relcounts_class, aes(x=description, y=taxon_rel_function_abun, fill = taxon)) +
geom_bar(position="stack", stat="identity")  +
scale_fill_manual(values=fam_cols, drop=T) +
labs(y= "Function relative abundance (Per taxon)", x="HC Degradation Pathways (Level 3 KEGG)")+ coord_flip() + facet_wrap(~sample, nrow = 1)
plot(plot7)
dev.off()
plot(plot7)
BiocManager::install("miaViz")
